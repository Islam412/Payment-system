{% load static %}
{% load i18n %}
{% get_current_language as LANGUAGE_CODE %}

<!doctype html>
<html lang=="en" {% if LANGUAGE_CODE == 'ar' %} dir="rtl" {% endif %}>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>{{ company_data.name }} - {% translate "Money Transfer and Online Payments Dashboard HTML Template" %}</title>

    <link rel="shortcut icon" href="{% static 'assets1/images/fav.png' %}" type="image/x-icon">
    <link rel="stylesheet" href="{% static 'assets1/css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets1/css/fontawesome.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets1/css/jquery-ui.css' %}">
    <link rel="stylesheet" href="{% static 'assets1/css/plugin/apexcharts.css' %}">
    <link rel="stylesheet" href="{% static 'assets1/css/plugin/nice-select.css' %}">
    <link rel="stylesheet" href="{% static 'assets1/css/arafat-font.css' %}">
    <link rel="stylesheet" href="{% static 'assets1/css/plugin/animate.css' %}">
    <link rel="stylesheet" href="{% static 'assets1/css/style.css' %}">
</head>
<style>
    .head-area {
        display: flex;
        align-items: center;
        padding: 15px;
        background-color: #f8f8f8;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        margin: 10px 0;
    }
    
    .profile-img {
        margin-right: 15px;
    }
    
    .profile-img img {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        object-fit: cover;
        border: 2px solid #ddd;
    }
    
    .profile-head {
        display: flex;
        flex-direction: column;
    }
    
    .profile-head h5 {
        font-size: 18px;
        font-weight: bold;
        margin: 0;
        color: #333;
    }
    
    .profile-head p {
        margin: 3px 0;
        font-size: 14px;
        color: #777;
    }
    
    .wallet-id {
        font-weight: 500;
    }
    
    .wallet-id:first-of-type {
        margin-top: 5px;
    }




    
.language-switcher {
  display: flex;
  justify-content: center;
  align-items: center;
  margin: 10px auto;
  font-family: "Poppins", sans-serif;
}

.language-box {
  display: flex;
  align-items: center;
  background: #ffffff;
  border: 1px solid #d1d5db;
  border-radius: 12px;
  padding: 6px 10px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
  transition: all 0.3s ease;
}

.language-box:hover {
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  border-color: #a0aec0;
}

.language-box select {
  border: none;
  outline: none;
  background: transparent;
  font-size: 14px;
  color: #333;
  padding: 6px 8px;
  cursor: pointer;
  appearance: none;
}

.language-box select:focus {
  outline: none;
}

.language-box button {
  background: linear-gradient(90deg, #4f46e5, #3b82f6);
  color: #fff;
  border: none;
  border-radius: 8px;
  padding: 6px 14px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  margin-left: 8px;
  transition: all 0.3s ease;
}

.language-box button:hover {
  background: linear-gradient(90deg, #4338ca, #2563eb);
  transform: translateY(-1px);
}

/* Dark Mode Overrides */
    body.dark-mode .language-box {
        background-color: var(--section-color);
        border-color: var(--border-color);
        color: var(--head-color);
    }

    /* Restored Dark Mode Variables */
    body.dark-mode {
        --body-color: #0f172a;
        --primary-color: #6366f1;
        --head-color: #f8fafc;
        --para-color: #cbd5e1;
        --section-primary-color: #1e293b;
        --section-color: #1e293b;
        --border-color: #334155;
        --bs-white: #1e293b;

        background-color: var(--body-color);
        color: var(--para-color);
    }

    /* Specific Element Overrides */
    body.dark-mode .head-area,
    body.dark-mode .header-section,
    body.dark-mode .sidebar-wrapper,
    body.dark-mode .dashboard-nav .single-item .main-area,
    body.dark-mode .form-control,
    body.dark-mode input,
    body.dark-mode select,
    body.dark-mode textarea {
        background-color: var(--section-primary-color) !important;
        color: var(--para-color) !important;
        border-color: var(--border-color) !important;
    }

    /* Text Color Fixes */
    body.dark-mode .profile-head h5,
    body.dark-mode .sidebar-wrapper ul li a span {
        color: var(--head-color);
    }

    body.dark-mode .profile-head p {
        color: var(--para-color);
    }

    body.dark-mode .sidebar-wrapper ul li a:hover span,
    body.dark-mode .sidebar-wrapper ul li a.active span {
        color: var(--primary-color);
    }

    /* Theme Toggle Switch */
    .theme-switch-wrapper {
        display: flex;
        align-items: center;
    }

    .theme-switch {
        display: inline-block;
        height: 24px;
        position: relative;
        width: 48px;
    }

    .theme-switch input {
        display: none;
    }

    .slider {
        background-color: #cbd5e1;
        bottom: 0;
        cursor: pointer;
        left: 0;
        position: absolute;
        right: 0;
        top: 0;
        transition: .4s;
        border-radius: 34px;
    }

    .slider:before {
        background-color: #fff;
        bottom: 3px;
        content: "";
        height: 18px;
        left: 4px;
        position: absolute;
        transition: .4s;
        width: 18px;
        border-radius: 50%;
    }

    input:checked+.slider {
        background-color: #6366f1;
    }

    input:checked+.slider:before {
        transform: translateX(24px);
    }

    .slider .icon {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        font-size: 10px;
        color: white;
        /* Adjusted for better visibility on color backgrounds */
        z-index: 10;
    }

    /* Adjust icon colors/positions */
    .slider .sun {
        left: 6px;
        color: #f59e0b;
    }

    input:checked+.slider .sun {
        display: none;
    }

    .slider .moon {
        right: 6px;
        color: #fbbf24;
        display: none;
    }

    input:checked+.slider .moon {
        display: block;
    }
</style>
<body>
    <!-- start preloader -->
    <!-- <div class="preloader" id="preloader"></div> -->
    <!-- end preloader -->

    <!-- Scroll To Top Start-->
    <a href="javascript:void(0)" class="scrollToTop"><i class="fas fa-angle-double-up"></i></a>
    <!-- Scroll To Top End -->

    <!-- header-section start -->
    <header class="header-section body-collapse">
        <div class="overlay">
            <div class="container-fruid">
                <div class="row d-flex header-area">
                    <div class="navbar-area d-flex align-items-center justify-content-between">
                        <div class="sidebar-icon">
                            <img src="{% static 'assets1/images/icon/menu.png' %}" alt="icon">
                        </div>
                        <!-- <form action="#" class="flex-fill">
                            <div class="form-group d-flex align-items-center">
                                <img src="{% static 'assets1/images/icon/search.png' %}" alt="icon">
                                <input type="text" placeholder="Type to search...">
                            </div>
                        </form> -->
                        <div class="dashboard-nav">
                            
                            <div class="single-item language-area">
                                <!-- <div class="language-btn">
                                    <img src="{% static 'assets1/images/icon/lang.png' %}" alt="icon">
                                </div> -->
                                <!-- <ul class="main-area language-content">
                                    <li>English</li>
                                    <li>Hindi</li>
                                    <li class="active">English (US)</li>
                                    <li>Japanese</li>
                                    <li>Kannada</li>
                                    <li>Lithuanian</li>
                                </ul> -->
                                

                               <form action="{% url 'set_language' %}" method="post" class="language-switcher">
                                    {% csrf_token %}
                                    <input type="hidden" name="next" value="{{ redirect_to }}">

                                    {% get_current_language as LANGUAGE_CODE %}
                                    {% get_available_languages as LANGUAGES %}
                                    {% get_language_info_list for LANGUAGES as languages %}

                                    <div class="language-box" style="display: flex; align-items: center; gap: 10px;">
                                        <select name="language" id="languageSelect" class="form-select" style="padding: 6px 10px;">
                                            {% for language in languages %}
                                                <option value="{{ language.code }}" {% if language.code == LANGUAGE_CODE %}selected{% endif %}>
                                                    {{ language.name_local }}
                                                </option>
                                            {% endfor %}
                                        </select>

                                        <button type="submit" class="btn btn-primary" style="padding: 6px 12px; border-radius: 6px;">
                                            {% if LANGUAGE_CODE == 'ar' %}
                                                {% translate "Translate to English" %}
                                            {% else %}
                                                ترجمة إلى العربية
                                            {% endif %}
                                        </button>

                                        <div class="theme-switch-wrapper">
                                            <label class="theme-switch" for="checkbox">
                                                <input type="checkbox" id="checkbox" />
                                                <div class="slider round">
                                                    <i class="fas fa-sun icon sun"></i>
                                                    <i class="fas fa-moon icon moon"></i>
                                                </div>
                                            </label>
                                        </div>
                                    </div>
                                </form>


                            </div>
                            



                            <div class="single-item notifications-area">
                                <div class="notifications-btn">
                                    <img src="{% static 'assets1/images/icon/bell.png' %}" class="bell-icon" alt="icon">
                                </div>

                                <div class="main-area notifications-content">
                                    <div class="head-area d-flex justify-content-between">
                                        <h5>Notifications</h5>
                                        <span class="mdr">{{ unread_count }}</span>
                                    </div>
                                        <!-- notifications.html -->
                                        <ul>

                                            {% for n in notifications %}
                                                <li>
                                                    <a href="javascript:void(0)" class="d-flex">
                                                        <div class="img-area">
                                                            <!-- <img src="{% static 'assets1/images/user-1.png' %}" class="max-un" alt="image"> -->
                                                            <img src="{{ n.sender_image_url|default:'/static/assets1/images/user-1.png' }}" class="max-un" style="width: 40px; height: 40px;" alt="image">
                                                        </div>

                                                        <div class="text-area">
                                                            <p class="mdr">{{ n.sender_full_name|title }}</p>

                                                            <p class="mdr">
                                                                {% if n.notification_type == "Credit Alert" %}
                                                                    You received <b>${{ n.amount }}</b>.
                                                                {% elif n.notification_type == "Debit Alert" %}
                                                                    You sent <b>${{ n.amount }}</b>.
                                                                {% elif n.notification_type == "Recieved Payment Request" %}
                                                                    You received a payment request of <b>${{ n.amount }}</b>.
                                                                {% elif n.notification_type == "Sent Payment Request" %}
                                                                    You sent a payment request of <b>${{ n.amount }}</b>.
                                                                {% elif n.notification_type == "Withdrew Credit Card Funds" %}
                                                                    You withdrew <b>${{ n.amount }}</b> from your credit card.
                                                                {% elif n.notification_type == "Deleted Credit Card" %}
                                                                    You deleted a credit card.
                                                                {% else %}
                                                                    {{ n.notification_type }} — ${{ n.amount }}
                                                                {% endif %}
                                                            </p>

                                                            
                                                            <p class="mdr time-area">{{ n.date|timesince }} ago</p>
                                                        </div>
                                                    </a>

                                                    <i class="fa-solid fa-caret-right"></i>
                                                </li>
                                            {% empty %}
                                                <li><p class="text-center mdr">No Notifications</p></li>
                                            {% endfor %}
                                        </ul>
                                </div>
                            </div>






                            <div class="single-item user-area">
                                <div class="profile-area d-flex align-items-center">
                                    <span class="user-profile">
                                        {% if request.user.kyc.image %}
                                            <img src="{{request.user.kyc.image.url}}" style="width: 60px; height: 60px; border-radius: 50%; object-fit: cover;" alt="image">
                                        {% else %}
                                            <img src="{% static 'assets1/images/default.jpg' %}" style="width: 50px; height: 50px; border-radius: 50%; object-fit: cover;" alt="image">
                                        {% endif %}
                                    </span>
                                    <i class="fa-solid fa-sort-down"></i>
                                </div>
                                <div class="main-area user-content">
                                    <form action="{% url 'account:account' %}">
                                        <div class="head-area d-flex align-items-center">
                                            <div class="profile-img">
                                                {% if request.user.kyc.image %}
                                                    <a href="{% url 'account:account' %}">
                                                        <img src="{{request.user.kyc.image.url}}" alt="image">
                                                    </a>
                                                {% else %}
                                                    <img src="{% static 'assets1/images/default.jpg' %}" alt="image">
                                                {% endif %}
                                            </div>
                                            <div class="profile-head">
                                                <a href="{% url 'account:account' %}">
                                                    <h5>{{request.user.username|title}}</h5>
                                                </a>
                                                <p class="wallet-id">{% translate "Account No" %}: {{request.user.account.account_number}}</p>
                                                <p class="wallet-id">{% translate "Pin No" %}: {{request.user.account.pin_number}}</p>
                                            </div>
                                        </div>
                                    </form>
                                    
                                    <ul>
                                        <li class="border-area">
                                            <a href="{% url 'account:kyc-registration' %}"><i class="fas fa-cog"></i>{% translate "Settings" %}</a>
                                        </li>
                                        <li>
                                            <a href="{% url 'userauths:sign-out' %}"><i class="fas fa-sign-out"></i>{% translate "Sign Out" %}</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sidebar-wrapper" {% if LANGUAGE_CODE == 'ar' %} dir="rtl" {% else %} dir="ltr" {% endif %}>
                        <div class="close-btn">
                            <i class="fa-solid fa-xmark"></i>
                        </div>
                        <div class="sidebar-logo">
                            <a href="/"><img src="{{ company_data.logo.url }}" alt="logo"></a>
                        </div>
                        <ul>
                            <li>
                                <a href="{% url 'account:dashboard' %}">
                                    <img src="{% static 'assets1/images/icon/dashboard.png' %}" alt="Dashboard"> <span>{% translate "Dashboard" %}</span>
                                </a>
                            </li>
                            <li>
                                <a href="{% url 'core:transactions' %}">
                                    <img src="{% static 'assets1/images/icon/transactions.png' %}" alt="Transactions"> <span>{% translate "Transactions" %}</span>
                                </a>
                            </li>
                            <li>
                                <a href="{% url 'core:search-account' %}">
                                    <img src="{% static 'assets1/images/icon/pay.png' %}" alt="Pay"> <span>{% translate "Pay" %}</span>
                                </a>
                            </li>
                            <li>
                                <a href="{% url 'core:request-search-account' %}">
                                    <img src="{% static 'assets1/images/icon/receive.png' %}" alt="Receive"> <span>{% translate "Receive" %}</span>
                                </a>
                            </li>
                            <!-- <li>
                                <a href="#">
                                    <img src="{% static 'assets1/images/icon/deposit.png' %}" alt="Deposit"> <span>Deposit Money</span>
                                </a>
                            </li>
                            <li>
                                <a href="withdraw-money-step-1.html">
                                    <img src="{% static 'assets1/images/icon/withdraw.png' %}" alt="Withdraw"> <span>Withdraw Money</span>
                                </a>
                            </li>

                            <li>
                                <a href="money-exchange.html">
                                    <img src="{% static 'assets1/images/icon/exchange.png' %}" alt="Exchange"> <span>Exchange</span>
                                </a>
                            </li>
                            <li>
                                <a href="recipients.html">
                                    <img src="{% static 'assets1/images/icon/recipients.png' %}" alt="Recipients"> <span>Recipients</span>
                                </a>
                            </li>
                            <li>
                                <a href="crypto.html">
                                    <img src="{% static 'assets1/images/icon/crypto.png' %}" alt="Crypto"> <span>Crypto</span>
                                </a>
                            </li> -->
                        </ul>
                        <ul class="bottom-item">
                            <li>
                                <a href="{% url 'core:about_us' %}">
                                    <img src="{% static 'assets1/images/icon/about_us.png' %}" style="width: 30px; height: 30px; grayscale(100%) brightness(60%) opacity(0.6); background-color: #BFC1DA;" alt="faq"> <span>{% translate "About Us" %}</span>
                                </a>
                            </li>

                            <li>
                                <a href="{% url 'core:contatct_us' %}">
                                    <img src="{% static 'assets1/images/icon/support.png' %}" alt="Contact Us"> <span>{% translate "Contact Us" %}</span>
                                </a>
                            </li>

                            <li>
                                <a href="{% url 'core:faq' %}">
                                    <img src="{% static 'assets1/images/icon/icon-faqs.png' %}" style="width: 30px; height: 30px; grayscale(100%) brightness(60%) opacity(0.6); background-color: #BFC1DA;" alt="faq"> <span>{% translate "FAQ" %}</span>
                                </a>
                            </li>

                            <li class="">
                                <a href="{% url 'account:account' %}">
                                    <img src="{% static 'assets1/images/icon/account.png' %}" alt="Account"> <span>{% translate "Account" %}</span>
                                </a>
                            </li>

                            <li>
                                <a href="{% url 'userauths:sign-out' %}">
                                    <img src="{% static 'assets1/images/icon/quit.png' %}" alt="Quit"> <span>{% translate "Quit" %}</span>
                                </a>
                            </li>

                        </ul>

                        <ul class="bottom-item">
                            {% if request.user.is_staff and request.user.is_superuser %}
                                <!-- ====== ADMIN SECTION ====== -->
                                <li class="admin-section mt-3" style="list-style: none; text-align: center; padding: 12px; border-radius: 12px; background: linear-gradient(135deg, #f1f3ff, #e7e9fc); box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                    <p style="margin-bottom: 8px; font-size: 13px; font-weight: 600; color: #5a5ccf; letter-spacing: 0.5px;">{% translate "Admin Area" %}</p>

                                    <a href="/admin/" style="display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 6px; text-decoration: none; color: #333;">
                                        <img src="{% static 'assets1/images/icon/adman.png' %}" 
                                            style="width: 30px; height: 30px; filter: grayscale(100%) brightness(65%) opacity(0.85);" 
                                            alt="Control Panel">
                                        <span style="font-weight: 500;">{% translate "Control Panel" %}</span>
                                    </a>

                                    <a href="{% url 'core:api-buttons' %}" style="display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 6px; text-decoration: none; color: #333;">
                                        <img src="{% static 'assets1/images/icon/api.jpg' %}" 
                                            style="width: 30px; height: 30px; filter: grayscale(100%) brightness(65%) opacity(0.85);" 
                                            alt="API">
                                        <span style="font-weight: 500;">{% translate "API" %}</span>
                                    </a>
                                </li>
                            {% endif %}
                        </ul>
                       
                    </div>
                </div>
            </div>
        </div>
        <!-- alert start -->
        
        {% if messages %}
            {% for sim in messages %}
            <div class="alert alert-{{sim.tags}}">
                <strong>{{sim}}</strong>
            </div>
            {% endfor %}
        {% endif %}
        <script>
            setTimeout (() => {
                $(".alert").alert("close");
            }, 4000)
        </script>
        
        <!-- alert end -->

    </header>
    <!-- header-section end -->

    {% block content %}
    
    {% endblock content %}

    <!--==================================================================-->
    <script src="{% static 'assets1/js/jquery.min.js' %}"></script>
    <script src="{% static 'assets1/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'assets1/js/jquery-ui.js' %}"></script>
    <script src="{% static 'assets1/js/plugin/apexcharts.js' %}"></script>
    <script src="{% static 'assets1/js/plugin/jquery.nice-select.min.js' %}"></script>
    <script src="{% static 'assets1/js/plugin/waypoint.min.js' %}"></script>
    <script src="{% static 'assets1/js/plugin/wow.min.js' %}"></script>
    <script src="{% static 'assets1/js/plugin/plugin.js' %}"></script>
    <script src="{% static 'assets1/js/main.js' %}"></script>

    <script>
        const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
        const currentTheme = localStorage.getItem('theme');

        if (currentTheme) {
            document.body.classList.add(currentTheme);

            if (currentTheme === 'dark-mode') {
                toggleSwitch.checked = true;
            }
        }

        function switchTheme(e) {
            if (e.target.checked) {
                document.body.classList.add('dark-mode');
                localStorage.setItem('theme', 'dark-mode');
            } else {
                document.body.classList.remove('dark-mode');
                localStorage.setItem('theme', 'light-mode');
            }
        }

        toggleSwitch.addEventListener('change', switchTheme, false);
    </script>
</body>

</html>