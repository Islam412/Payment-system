{% load static %}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
    body {
        background: #f4f6fb;
        font-family: 'Segoe UI', sans-serif;
    }

    .delete-card-container {
        max-width: 820px;
        margin: 60px auto;
        background: #fff;
        padding: 50px;
        border-radius: 24px;
        box-shadow: 0 15px 40px rgba(0,0,0,0.07);
        animation: fadeIn .6s ease;
    }

    @keyframes fadeIn {
        from {opacity: 0; transform: translateY(20px);}
        to {opacity: 1; transform: translateY(0);}
    }

    /* ------- اختيار البطاقة ------- */
    .card-option {
        border: 2px solid transparent;
        border-radius: 18px;
        cursor: pointer;
        padding-bottom: 12px;
        transition: .3s ease-in-out;
        position: relative;
    }

    .card-option:hover {
        border-color: #0d6efd;
        background: #f1f5ff;
    }

    .card-option input[type=radio] {
        accent-color: #0d6efd;
        transform: scale(1.4);
    }

    /* ------- البطاقة البنكية ------- */
    .bank-card {
        background: linear-gradient(135deg, #0d6efd, #003a8c);
        color: white;
        padding: 26px;
        border-radius: 20px;
        position: relative;
        overflow: hidden;
        transition: transform .3s ease, box-shadow .3s ease;
        box-shadow: 0 6px 15px rgba(0,0,0,0.18);
    }

    /* ألوان حسب نوع البطاقة */
    .visa-card {
        background: linear-gradient(135deg, #2d6dff, #0f33a8);
    }

    .master-card {
        background: linear-gradient(135deg, #ff7a1e, #c23e00);
    }

    .Verve-card {
        background: linear-gradient(135deg, #00c864, #007838);
    }

    /* ===== تأثير ضوئي متحرك حسب نوع البطاقة ===== */
    .bank-card::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        border-radius: 50%;
        background: rgba(255,255,255,0.1);
        pointer-events: none;
        z-index: 0;
        transform: scale(0);
        transition: transform 0.5s ease, opacity 0.5s ease;
    }

    .card-option:hover .bank-card {
        transform: translateY(-5px) scale(1.02);
    }

    .visa-card:hover::before {
        background: rgba(45, 109, 255, 0.25);
        transform: scale(1);
    }

    .master-card:hover::before {
        background: rgba(255, 122, 30, 0.25);
        transform: scale(1);
    }

    .Verve-card:hover::before {
        background: rgba(0, 200, 100, 0.25);
        transform: scale(1);
    }

    /* اجعل محتوى البطاقة فوق التأثير */
    .bank-card > * {
        position: relative;
        z-index: 2;
    }

    /* سطر الاسم ونوع البطاقة */
    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 22px;
    }

    .card-header h5 {
        margin: 0;
        font-weight: 600;
        font-size: 20px;
    }

    .card-type {
        font-size: 16px;
        font-weight: bold;
        padding: 6px 12px;
        border-radius: 10px;
        background: rgba(255,255,255,0.22);
        backdrop-filter: blur(4px);
    }

    .bank-card-number {
        font-size: 27px;
        letter-spacing: 2px;
        font-weight: 600;
        margin-bottom: 22px;
    }

    .card-info {
        display: flex;
        justify-content: space-between;
        font-size: 15px;
        letter-spacing: .6px;
    }

    /* زر الحذف */
    .delete-btn {
        width: 100%;
        font-size: 19px;
        font-weight: 700;
        padding: 15px;
        border-radius: 14px;
        background: #dc3545;
        border: none;
        transition: .3s;
    }

    .delete-btn:hover {
        background: #bb2d3b;
        box-shadow: 0 4px 14px rgba(220,53,69,0.4);
        transform: translateY(-2px);
    }

    .cancel-btn {
        font-size: 17px;
        border-radius: 14px;
        padding: 13px;
    }
</style>

<div class="delete-card-container">

    <h3 class="text-danger fw-bold mb-3 d-flex align-items-center">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>
        Delete Account
    </h3>

    <p class="text-muted mb-4 fs-5">
        Choose the credit card to receive your remaining account balance:
    </p>

    <form method="post">
        {% csrf_token %}

        {% for card in cards %}
            <label class="card-option w-100 mb-4">

                <div class="bank-card 
                    {% if card.card_type|lower == 'visa' %}visa-card{% endif %}
                    {% if card.card_type|lower == 'master' %}master-card{% endif %}
                    {% if card.card_type|lower == 'verve' %}Verve-card{% endif %}
                ">
                    <div class="card-header">
                        <h5>{{ card.name }}</h5>
                        <div class="card-type">{{ card.card_type|upper }}</div>
                    </div>

                    <div class="bank-card-number">
                        {{ card.number|slice:":4" }} •••• •••• {{ card.number|slice:"-4:" }}
                    </div>

                    <div class="card-info">
                        <div><strong>EXP:</strong> {{ card.month }}/{{ card.year }}</div>
                        <div><strong>CVV:</strong> ***</div>
                        <div><strong>Balance:</strong> {{ card.amount }} $</div>
                    </div>
                </div>

                <div class="d-flex align-items-center mt-2 px-1">
                    <input type="radio" name="card_id" value="{{ card.id }}" required class="me-2">
                    <span class="fw-semibold">Select this card</span>
                </div>

            </label>
        {% endfor %}

        <button class="btn btn-danger delete-btn mt-3">
            <i class="bi bi-trash"></i> Confirm & Delete My Account
        </button>

        <a href="{% url 'account:dashboard' %}" class="btn btn-secondary cancel-btn mt-3 w-100">
            Cancel
        </a>
    </form>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.js"></script>
